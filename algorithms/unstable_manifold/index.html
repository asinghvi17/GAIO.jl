<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stable and Unstable Manifold · GAIO.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GAIO.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GAIO.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../general/">General usage</a></li><li><span class="tocitem">BoxMaps</span><ul><li><a class="tocitem" href="../../boxmaps/boxmaps_general/">An Overview of BoxMap Types</a></li><li><a class="tocitem" href="../../boxmaps/montecarlo/"><code>MonteCarloBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/grid/"><code>GridBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/adaptive/"><code>AdaptiveBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/interval/"><code>IntervalBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/boxmaps_simd/"><code>CPUSampledBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/boxmaps_cuda/"><code>GPUSampledBoxmap</code></a></li><li><a class="tocitem" href="../../boxmaps/pointdiscretized/"><code>PointDiscretizedBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/sampled/"><code>SampledBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/new_types/">Creating you own BoxMap type</a></li></ul></li><li><span class="tocitem">Invariant Sets</span><ul><li><a class="tocitem" href="../relative_attractor/">Relative Attractor</a></li><li><a class="tocitem" href="../chain_recurrent_set/">Chain Reccurent Set</a></li><li><a class="tocitem" href="../maximal_invariant_set/">Maximal Invariant Set</a></li><li class="is-active"><a class="tocitem" href>Stable and Unstable Manifold</a></li></ul></li><li><span class="tocitem">Transfer- and Koopman Operators</span><ul><li><a class="tocitem" href="../transfer_operator/">Ulam&#39;s method and Invariant Measures</a></li><li><a class="tocitem" href="../almost_invariant/">Almost Invariant (metastable) Sets</a></li><li><a class="tocitem" href="../cyclic/">Cyclic Sets</a></li><li><a class="tocitem" href="../coherent/">Coherent Sets</a></li><li><a class="tocitem" href="../seba/">Extracting Multiple Sets via SEBA</a></li></ul></li><li><span class="tocitem">Scalar Diagnostics</span><ul><li><a class="tocitem" href="../box_dimension/">Fractal Dimension</a></li><li><a class="tocitem" href="../ftle/">Lyapunov Exponents / FTLEs</a></li></ul></li><li><span class="tocitem">Misceallenous Algorithms</span><ul><li><a class="tocitem" href="../root_covering/">Root Covering</a></li><li><a class="tocitem" href="../implicit_manifold/">Covering Implicitly Defined Manifolds</a></li></ul></li><li><a class="tocitem" href="../../plotting/">Plotting</a></li><li><span class="tocitem">Maximizing Performance</span><ul><li><a class="tocitem" href="../../simd/">Using the CPU</a></li><li><a class="tocitem" href="../../cuda/">Using the GPU (Nvidia)</a></li></ul></li><li><a class="tocitem" href="../../examples/">Other Examples</a></li><li><a class="tocitem" href="../../library_reference/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Invariant Sets</a></li><li class="is-active"><a href>Stable and Unstable Manifold</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stable and Unstable Manifold</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gaioguys/GAIO.jl/blob/master/docs/src/algorithms/unstable_manifold.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Unstable-Set"><a class="docs-heading-anchor" href="#Unstable-Set">Unstable Set</a><a id="Unstable-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Unstable-Set" title="Permalink"></a></h1><p>In the following we are presenting the algorithm to cover invariant manifolds within some domain <span>$Q$</span>, which has to contain a fixed point.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For simplicity, we will explain the algorithm for the case of the <em>unstable manifold</em>. However one can compute the stable manifold as well by considering the boxmap describing the inverse map <span>$f^{-1}$</span> as input argument for the algorithm.</p></div></div><h3 id="Mathematical-Background"><a class="docs-heading-anchor" href="#Mathematical-Background">Mathematical Background</a><a id="Mathematical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Background" title="Permalink"></a></h3><p>The unstable manifold is defined as</p><p class="math-container">\[W^U(x_0) = \{x: \lim_{k \to - \infty} f^k(x) = x_0 \}\]</p><p>where <span>$x_0$</span> is a fixed point of <span>$f$</span>.</p><p>The idea behind the algorithm [1] to compute the unstable manifold can be explained in two steps. Before starting we need to identify a hyperbolic fixed point and the region <span>$Q$</span>, which we are going to compute the manifold in. The region <span>$Q$</span> needs to be already partitioned into small boxes.</p><ol><li><strong>initialization step</strong> Since a fixed point is always part of the unstable manifold, we need to identify a small region/box containing this fixed point. This box may be known a-priori, or one can use the <code>relative_attractor</code> around a small region where one suspects a fixed point to exist. </li><li><strong>continuation step</strong> The small box containing the fixed point is then mapped forward by <code>F</code> and the boxes that are hit under the image are added to the box collection. Then those newly included boxes are mapped forward and the procedure is repeated until no new boxes are added. </li></ol><div class="admonition is-warning"><header class="admonition-header">Note on Convergence</header><div class="admonition-body"><p>One might not be able to compute the parts of the unstable manifold whose preimage lies outside the domain <span>$Q$</span>. Thus, it is important to choose <span>$Q$</span> large enough.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="GAIO.unstable_set" href="#GAIO.unstable_set"><code>GAIO.unstable_set</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unstable_set(F::BoxMap, B::BoxSet) -&gt; BoxSet</code></pre><p>Compute the unstable set for a box set <code>B</code>. Generally, <code>B</code> should be  a small box surrounding a fixed point of <code>F</code>. The partition must  be fine enough, since no subdivision occurs in this algorithm. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaioguys/GAIO.jl/blob/bac727f9d2edc3a6adc6951db6321cd46c9e3870/src/algorithms.jl#L17-L23">source</a></section></article><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><pre><code class="language-julia hljs">using GAIO

# the Lorenz system
const σ, ρ, β = 10.0, 28.0, 0.4
v((x,y,z)) = (σ*(y-x), ρ*x-y-x*z, x*y-β*z)

# time-0.2 flow map
f(x) = rk4_flow_map(v, x)

center, radius = (0,0,25), (30,30,30)
Q = Box(center, radius)
P = BoxPartition(Q, (256,256,256))
F = BoxMap(:adaptive, f, Q)

# equilibrium
x = (sqrt(β*(ρ-1)), sqrt(β*(ρ-1)), ρ-1)
S = cover(P, x)

W = unstable_set(F, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">202300 - element BoxSet in 256 x 256 x 256 - element BoxPartition</code></pre><pre><code class="language-julia hljs">using GLMakie

fig, ax, ms = plot(W);</code></pre><p><img src="../unstable_manifold.png" alt="Unstable manifold"/></p><p>We can animate this plot using the <code>record</code> function from Makie.jl</p><pre><code class="language-julia hljs">fig = Figure();
ax = Axis3(fig[1,1], viewmode=:fit)
ms = plot!(ax, W, color=(:red, 0.6))

record(fig, &quot;unstable.gif&quot;, 1:240) do frame
    v = sin(2pi * frame / 240)
    ax.elevation[] = pi/8 - pi * v / 10
    ax.azimuth[] = pi * v / 2
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;unstable.gif&quot;</code></pre><p><img src="../unstable.gif" alt="Unstable Manifold Gif"/></p><pre><code class="language-julia hljs">fig, ax, ms = plot(W);</code></pre><pre><code class="language-julia hljs"># integrate in reverse time:
# 5 steps of rk4 method with step size -0.01
f(x) = rk4_flow_map(v, x, -0.01, 5)

center, radius = (0,0,25), (120,180,160)
Q = Box(center, radius)
P = BoxPartition(Q, (256,256,256))
F = BoxMap(:grid, f, Q, n_points=(8,8,8))

# Equillibrium (0,0,0) lies at the bottom corner of one box.
# Cover a small neighborhood of (0,0,0) instead
x = Box( (0,0,0), 0.01 .* (1,1,1) )
S = cover(P, x)

W2 = unstable_set(F, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">397144 - element BoxSet in 256 x 256 x 256 - element BoxPartition</code></pre><pre><code class="language-julia hljs">fig = Figure();
ax = Axis3(fig[1,1], azimuth=0.62*pi)
ms = plot!(ax, W2)</code></pre><p><img src="../stable_manifold.png" alt="Stable manifold"/></p><pre><code class="language-julia hljs">record(fig, &quot;stable.gif&quot;, 1:240) do frame
    v = sin(2pi * frame / 240)
    ax.elevation[] = pi/10 - pi * v / 20
    ax.azimuth[] = -pi / 5 + 2pi * v / 5
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;stable.gif&quot;</code></pre><p><img src="../stable.gif" alt="Stable Manifold Gif"/></p><h3 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h3><pre><code class="language-julia hljs">function unstable_set(F::BoxMap, B::BoxSet)
    B₀ = B
    B₁ = B
    while !isempty(B₁)
        B₁ = F(B₁)          # map the current interation forward
        setdiff!(B₁, B₀)    # remove boxes we&#39;ve already seen
        union!(B₀, B₁)      # add the new boxes to the collection
    end
    return B₀
end</code></pre><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><p>[1] Michael Dellnitz and Adreas Hohmann. “The Computation of Unstable Manifolds Using Subdivision”. In: <em>Nonlinear Systems and Chaos</em>. Ed. by Haim Brezis. Vol. 19. Progress in Nonlinear Differential Equations and their Applications. 1996, pp. 449–459. doi: https://doi.org/10.1007/978-3-0348-7518-9.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../maximal_invariant_set/">« Maximal Invariant Set</a><a class="docs-footer-nextpage" href="../transfer_operator/">Ulam&#39;s method and Invariant Measures »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 24 April 2023 09:26">Monday 24 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
